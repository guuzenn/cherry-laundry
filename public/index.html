<html
  :class="{ 'theme-dark': dark }"
  x-data="root"
  x-init="await init()"
  lang="en"
>
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Dasbor - Cherry Laundry</title>
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>

    <link
      href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap"
      rel="stylesheet"
    />
    <link rel="stylesheet" href="./assets/css/tailwind.output.css" />
    <script
      src="https://cdn.jsdelivr.net/npm/alpinejs@3.10.3/dist/cdn.min.js"
      defer
    ></script>
    <link
      href="https://cdnjs.cloudflare.com/ajax/libs/flowbite/2.3.0/flowbite.min.css"
      rel="stylesheet"
    />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/flowbite/2.3.0/flowbite.min.js"></script>
    <!-- Icons -->
    <script
      src="https://kit.fontawesome.com/f87eaab4e6.js"
      crossorigin="anonymous"
    ></script>
  </head>
  <body>
    <div
      class="flex h-screen bg-gray-50 dark:bg-gray-900"
      :class="{ 'overflow-hidden': isSideMenuOpen }"
    >
      <aside
        class="z-20 flex-shrink-0 hidden w-64 overflow-y-auto bg-white dark:bg-gray-800 md:block"
      >
        <div class="py-4 text-gray-500 dark:text-gray-400">
          <a
            class="ml-6 text-lg font-bold text-gray-800 dark:text-gray-200"
            href="#"
          >
            Cherry Laundry
          </a>
          <ul class="mt-6">
            <li class="relative px-6 py-3">
              <span
                class="absolute inset-y-0 left-0 w-1 bg-blue-600 rounded-tr-lg rounded-br-lg"
                aria-hidden="true"
              ></span>
              <a
                class="inline-flex items-center w-full text-sm font-semibold transition-colors duration-150 hover:text-gray-800 dark:hover:text-gray-200"
                href="../"
              >
                <svg
                  class="w-5 h-5"
                  aria-hidden="true"
                  fill="none"
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="2"
                  viewBox="0 0 24 24"
                  stroke="currentColor"
                >
                  <path
                    d="M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6"
                  ></path>
                </svg>
                <span class="ml-4">Beranda</span>
              </a>
            </li>
          </ul>
          <ul>
            <li class="relative px-6 py-3">
              <a
                class="inline-flex items-center w-full text-sm font-semibold text-gray-800 transition-colors duration-150 hover:text-gray-800 dark:hover:text-gray-200 dark:text-gray-100"
                href="customers/"
              >
                <svg
                  class="w-5 h-5"
                  aria-hidden="true"
                  fill="none"
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="2"
                  viewBox="0 0 24 24"
                  stroke="currentColor"
                >
                  <path d="M4 6h16M4 10h16M4 14h16M4 18h16"></path>
                </svg>
                <span class="ml-4">Pelanggan</span>
              </a>
            </li>
          </ul>
        </div>
      </aside>
      <div
        x-show="isSideMenuOpen"
        x-transition:enter="transition ease-in-out duration-150"
        x-transition:enter-start="opacity-0"
        x-transition:enter-end="opacity-100"
        x-transition:leave="transition ease-in-out duration-150"
        x-transition:leave-start="opacity-100"
        x-transition:leave-end="opacity-0"
        class="fixed inset-0 z-10 flex items-end bg-black bg-opacity-50 sm:items-center sm:justify-center"
      ></div>
      <aside
        class="fixed inset-y-0 z-20 flex-shrink-0 w-64 mt-16 overflow-y-auto bg-white dark:bg-gray-800 md:hidden"
        x-show="isSideMenuOpen"
        x-transition:enter="transition ease-in-out duration-150"
        x-transition:enter-start="opacity-0 transform -translate-x-20"
        x-transition:enter-end="opacity-100"
        x-transition:leave="transition ease-in-out duration-150"
        x-transition:leave-start="opacity-100"
        x-transition:leave-end="opacity-0 transform -translate-x-20"
        @click.away="closeSideMenu"
        @keydown.escape="closeSideMenu"
      >
        <div class="py-4 text-gray-500 dark:text-gray-400">
          <a
            class="ml-6 text-lg font-bold text-gray-800 dark:text-gray-200"
            href="#"
          >
            Cherry Laundry
          </a>
          <ul class="mt-6">
            <li class="relative px-6 py-3">
              <a
                class="inline-flex items-center w-full text-sm font-semibold transition-colors duration-150 hover:text-gray-800 dark:hover:text-gray-200"
                href="index.html"
              >
                <svg
                  class="w-5 h-5"
                  aria-hidden="true"
                  fill="none"
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="2"
                  viewBox="0 0 24 24"
                  stroke="currentColor"
                >
                  <path
                    d="M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6"
                  ></path>
                </svg>
                <span class="ml-4">Beranda</span>
              </a>
            </li>
          </ul>
          <ul>
            <li class="relative px-6 py-3">
              <span
                class="absolute inset-y-0 left-0 w-1 bg-blue-600 rounded-tr-lg rounded-br-lg"
                aria-hidden="true"
              ></span>
              <a
                class="inline-flex items-center w-full text-sm font-semibold text-gray-800 transition-colors duration-150 hover:text-gray-800 dark:hover:text-gray-200 dark:text-gray-100"
                href="tables.html"
              >
                <svg
                  class="w-5 h-5"
                  aria-hidden="true"
                  fill="none"
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="2"
                  viewBox="0 0 24 24"
                  stroke="currentColor"
                >
                  <path d="M4 6h16M4 10h16M4 14h16M4 18h16"></path>
                </svg>
                <span class="ml-4">Pelanggan</span>
              </a>
            </li>
          </ul>
        </div>
      </aside>
      <div class="flex flex-col flex-1 w-full">
        <header class="z-10 py-4 bg-white shadow-md dark:bg-gray-800">
          <div
            class="container flex items-center justify-between h-full px-6 mx-auto text-blue-600 dark:text-blue-300"
          >
            <!-- Mobile hamburger -->
            <button
              class="p-1 mr-5 -ml-1 rounded-md md:hidden focus:outline-none focus:shadow-outline-blue"
              @click="toggleSideMenu"
              aria-label="Menu"
            >
              <svg
                class="w-6 h-6"
                aria-hidden="true"
                fill="currentColor"
                viewBox="0 0 20 20"
              >
                <path
                  fill-rule="evenodd"
                  d="M3 5a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zM3 10a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zM3 15a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1z"
                  clip-rule="evenodd"
                ></path>
              </svg>
            </button>
            <!-- Search input -->
            <div class="flex justify-center flex-1 lg:mr-32">
              <div
                class="relative w-full max-w-xl mr-6 focus-within:text-blue-500"
              >
                <div class="absolute inset-y-0 flex items-center pl-2">
                  <svg
                    class="w-4 h-4"
                    aria-hidden="true"
                    fill="currentColor"
                    viewBox="0 0 20 20"
                  >
                    <path
                      fill-rule="evenodd"
                      d="M8 4a4 4 0 100 8 4 4 0 000-8zM2 8a6 6 0 1110.89 3.476l4.817 4.817a1 1 0 01-1.414 1.414l-4.816-4.816A6 6 0 012 8z"
                      clip-rule="evenodd"
                    ></path>
                  </svg>
                </div>
                <input
                  class="w-full pl-8 pr-2 text-sm text-gray-700 placeholder-gray-600 bg-gray-100 border-0 rounded-md dark:placeholder-gray-500 dark:focus:shadow-outline-gray dark:focus:placeholder-gray-600 dark:bg-gray-700 dark:text-gray-200 focus:placeholder-gray-500 focus:bg-white focus:border-blue-300 focus:outline-none focus:shadow-outline-blue form-input"
                  type="text"
                  placeholder="Cari pesanan"
                  aria-label="Search"
                />
              </div>
            </div>
            <ul class="flex items-center flex-shrink-0 space-x-6">
              <button
                class="rounded-md focus:outline-none focus:shadow-outline-blue"
                @click="toggleTheme"
                aria-label="Toggle color mode"
              >
                <template x-if="!dark">
                  <svg
                    class="w-5 h-5"
                    aria-hidden="true"
                    fill="currentColor"
                    viewBox="0 0 20 20"
                  >
                    <path
                      d="M17.293 13.293A8 8 0 016.707 2.707a8.001 8.001 0 1010.586 10.586z"
                    ></path>
                  </svg>
                </template>
                <template x-if="dark">
                  <svg
                    class="w-5 h-5"
                    aria-hidden="true"
                    fill="currentColor"
                    viewBox="0 0 20 20"
                  >
                    <path
                      fill-rule="evenodd"
                      d="M10 2a1 1 0 011 1v1a1 1 0 11-2 0V3a1 1 0 011-1zm4 8a4 4 0 11-8 0 4 4 0 018 0zm-.464 4.95l.707.707a1 1 0 001.414-1.414l-.707-.707a1 1 0 00-1.414 1.414zm2.12-10.607a1 1 0 010 1.414l-.706.707a1 1 0 11-1.414-1.414l.707-.707a1 1 0 011.414 0zM17 11a1 1 0 100-2h-1a1 1 0 100 2h1zm-7 4a1 1 0 011 1v1a1 1 0 11-2 0v-1a1 1 0 011-1zM5.05 6.464A1 1 0 106.465 5.05l-.708-.707a1 1 0 00-1.414 1.414l.707.707zm1.414 8.486l-.707.707a1 1 0 01-1.414-1.414l.707-.707a1 1 0 011.414 1.414zM4 11a1 1 0 100-2H3a1 1 0 000 2h1z"
                      clip-rule="evenodd"
                    ></path>
                  </svg>
                </template>
              </button>
              <!-- Profile menu -->
              <li class="relative">
                <button
                  class="align-middle rounded-full focus:shadow-outline-blue focus:outline-none"
                  @click="toggleProfileMenu"
                  @keydown.escape="closeProfileMenu"
                  aria-label="Account"
                  aria-haspopup="true"
                >
                  <img
                    class="object-cover w-8 h-8 rounded-full"
                    src="https://static.vecteezy.com/system/resources/previews/029/156/453/original/admin-business-icon-businessman-business-people-male-avatar-profile-pictures-man-in-suit-for-your-web-site-design-logo-app-ui-solid-style-illustration-design-on-white-background-eps-10-vector.jpg"
                    alt=""
                    aria-hidden="true"
                  />
                </button>
                <template x-if="isProfileMenuOpen">
                  <ul
                    x-transition:leave="transition ease-in duration-150"
                    x-transition:leave-start="opacity-100"
                    x-transition:leave-end="opacity-0"
                    @click.away="closeProfileMenu"
                    @keydown.escape="closeProfileMenu"
                    class="absolute right-0 w-56 p-2 mt-2 space-y-2 text-gray-600 bg-white border border-gray-100 rounded-md shadow-md dark:border-gray-700 dark:text-gray-300 dark:bg-gray-700"
                    aria-label="submenu"
                  >
                    <li class="flex">
                      <a
                        class="inline-flex items-center w-full px-2 py-1 text-sm font-semibold transition-colors duration-150 rounded-md hover:bg-gray-100 hover:text-gray-800 dark:hover:bg-gray-800 dark:hover:text-gray-200"
                        href="#"
                      >
                        <svg
                          class="w-4 h-4 mr-3"
                          aria-hidden="true"
                          fill="none"
                          stroke-linecap="round"
                          stroke-linejoin="round"
                          stroke-width="2"
                          viewBox="0 0 24 24"
                          stroke="currentColor"
                        >
                          <path
                            d="M11 16l-4-4m0 0l4-4m-4 4h14m-5 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h7a3 3 0 013 3v1"
                          ></path>
                        </svg>
                        <span>Log out</span>
                      </a>
                    </li>
                  </ul>
                </template>
              </li>
            </ul>
          </div>
        </header>
        <main class="h-full overflow-y-auto">
          <div class="flex items-center my-6 container px-6 mx-auto">
            <h2 class="text-2xl font-semibold text-gray-700 dark:text-gray-200">
              Beranda Pemesanan
            </h2>
            <button
              data-modal-toggle="create-modal"
              type="button"
              class="flex items-center justify-between px-2 py-2 text-sm font-medium leading-5 text-blue-600 rounded-lg dark:text-gray-400 focus:outline-none focus:shadow-outline-gray"
              aria-label="Add"
              @click="openModal()"
            >
              <svg
                class="h-6 w-6 ml-2"
                xmlns="http://www.w3.org/2000/svg"
                width="20"
                height="20"
                viewBox="0 0 20 20"
                fill="none"
                :class="{ 'text-black': !dark, 'text-white': dark }"
              >
                <path
                  d="M2.5 5C2.5 4.83424 2.56585 4.67527 2.68306 4.55806C2.80027 4.44085 2.95924 4.375 3.125 4.375H16.875C17.0408 4.375 17.1997 4.44085 17.3169 4.55806C17.4342 4.67527 17.5 4.83424 17.5 5C17.5 5.16576 17.4342 5.32473 17.3169 5.44194C17.1997 5.55915 17.0408 5.625 16.875 5.625H3.125C2.95924 5.625 2.80027 5.55915 2.68306 5.44194C2.56585 5.32473 2.5 5.16576 2.5 5ZM3.125 10.625H16.875C17.0408 10.625 17.1997 10.5592 17.3169 10.4419C17.4342 10.3247 17.5 10.1658 17.5 10C17.5 9.83424 17.4342 9.67527 17.3169 9.55806C17.1997 9.44085 17.0408 9.375 16.875 9.375H3.125C2.95924 9.375 2.80027 9.44085 2.68306 9.55806C2.56585 9.67527 2.5 9.83424 2.5 10C2.5 10.1658 2.56585 10.3247 2.68306 10.4419C2.80027 10.5592 2.95924 10.625 3.125 10.625ZM11.25 14.375H3.125C2.95924 14.375 2.80027 14.4408 2.68306 14.5581C2.56585 14.6753 2.5 14.8342 2.5 15C2.5 15.1658 2.56585 15.3247 2.68306 15.4419C2.80027 15.5592 2.95924 15.625 3.125 15.625H11.25C11.4158 15.625 11.5747 15.5592 11.6919 15.4419C11.8092 15.3247 11.875 15.1658 11.875 15C11.875 14.8342 11.8092 14.6753 11.6919 14.5581C11.5747 14.4408 11.4158 14.375 11.25 14.375ZM18.125 14.375H16.875V13.125C16.875 12.9592 16.8092 12.8003 16.6919 12.6831C16.5747 12.5658 16.4158 12.5 16.25 12.5C16.0842 12.5 15.9253 12.5658 15.8081 12.6831C15.6908 12.8003 15.625 12.9592 15.625 13.125V14.375H14.375C14.2092 14.375 14.0503 14.4408 13.9331 14.5581C13.8158 14.6753 13.75 14.8342 13.75 15C13.75 15.1658 13.8158 15.3247 13.9331 15.4419C14.0503 15.5592 14.2092 15.625 14.375 15.625H15.625V16.875C15.625 17.0408 15.6908 17.1997 15.8081 17.3169C15.9253 17.4342 16.0842 17.5 16.25 17.5C16.4158 17.5 16.5747 17.4342 16.6919 17.3169C16.8092 17.1997 16.875 17.0408 16.875 16.875V15.625H18.125C18.2908 15.625 18.4497 15.5592 18.5669 15.4419C18.6842 15.3247 18.75 15.1658 18.75 15C18.75 14.8342 18.6842 14.6753 18.5669 14.5581C18.4497 14.4408 18.2908 14.375 18.125 14.375Z"
                  :fill="dark ? 'white' : 'black'"
                />
              </svg>
            </button>
            <!-- Main modal -->
            <div
              id="create-modal"
              tabindex="-1"
              aria-hidden="true"
              x-show="isModalOpen"
              class="overflow-y-auto overflow-x-hidden fixed top-0 right-0 left-0 z-50 justify-center items-center w-full md:inset-0 h-[calc(100%-1rem)] max-h-full flex"
            >
              <div
                class="relative p-4 w-full max-w-md max-h-full"
                @click.outside="closeModal()"
              >
                <!-- Modal content -->
                <div
                  class="relative bg-white rounded-lg shadow dark:bg-gray-700"
                >
                  <!-- Modal header -->
                  <div
                    class="flex items-center justify-between p-4 md:p-5 border-b rounded-t dark:border-gray-600"
                  >
                    <h3
                      class="text-lg font-semibold text-gray-900 dark:text-white"
                    >
                      Tambah Data Pemesanan
                    </h3>
                    <button
                      type="button"
                      class="text-gray-400 bg-transparent hover:bg-gray-200 hover:text-gray-900 rounded-lg text-sm w-8 h-8 ms-auto inline-flex justify-center items-center dark:hover:bg-gray-600 dark:hover:text-white"
                      data-modal-toggle="create-modal"
                      @click="closeModal()"
                    >
                      <svg
                        class="w-5 h-5"
                        aria-hidden="true"
                        fill="currentColor"
                        viewBox="0 0 20 20"
                        xmlns="http://www.w3.org/2000/svg"
                      >
                        <path
                          stroke="currentColor"
                          stroke-linecap="round"
                          stroke-linejoin="round"
                          stroke-width="2"
                          d="m1 1 6 6m0 0 6 6M7 7l6-6M7 7l-6 6"
                        />
                      </svg>
                      <span class="sr-only">Close modal</span>
                    </button>
                  </div>
                  <!-- Modal body -->
                  <form
                    class="p-4 md:p-5"
                    @submit.prevent="submitAddTransactions"
                  >
                    <div class="grid gap-4 mb-4 grid-cols-2">
                      <div class="col-span-2">
                        <label
                          for="idPelangganAdd"
                          class="block mb-2 text-sm font-medium text-gray-900 dark:text-white"
                        >
                          Pelanggan
                        </label>
                        <select
                          id="idPelangganAdd"
                          x-model="addTransactionData.customer_id"
                          class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-primary-500 focus:border-primary-500 block w-full p-2.5 dark:bg-gray-600 dark:border-gray-500 dark:text-black-400 dark:placeholder-gray-400 dark:focus:ring-primary-500 dark:focus:border-primary-500"
                          required
                        >
                          <option
                            selected
                            disabled
                            class="text-gray-500 dark:text-black-400"
                            value=""
                          >
                            Pilih ID
                          </option>
                          <template x-for="customer in customers.reverse()">
                            <option
                              :value="customer.id"
                              class="text-gray-500 dark:text-black-400"
                              x-text="`${customer.id} - ${customer.name}`"
                            ></option>
                          </template>
                        </select>
                      </div>

                      <div class="col-span-2">
                        <label
                          for="priceAdd"
                          class="block mb-2 text-sm font-medium text-gray-900 dark:text-white"
                        >
                          Harga
                        </label>
                        <input
                          type="number"
                          name="priceAdd"
                          id="priceAdd"
                          class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-primary-600 focus:border-primary-600 block w-full p-2.5 dark:bg-gray-600 dark:border-gray-500 dark:text-black-400 dark:placeholder-gray-400 dark:focus:ring-primary-500 dark:focus:border-primary-500"
                          placeholder="Rp. -"
                          required
                          x-model="addTransactionData.total_amount"
                        />
                      </div>
                      <div class="col-span-2">
                        <label
                          for="statusAdd"
                          class="block mb-2 text-sm font-medium text-gray-900 dark:text-white"
                        >
                          Status
                        </label>
                        <select
                          id="statusAdd"
                          class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-primary-500 focus:border-primary-500 block w-full p-2.5 dark:bg-gray-600 dark:border-gray-500 dark:text-black-400 dark:placeholder-gray-400 dark:focus:ring-primary-500 dark:focus:border-primary-500"
                          x-model="addTransactionData.status"
                        >
                          <option
                            selected
                            disabled
                            class="text-gray-500 dark:text-black-400"
                          >
                            Pilih Status
                          </option>
                          <option
                            value="PRC"
                            class="text-gray-900 dark:text-black-400"
                          >
                            DIPROSES
                          </option>
                          <option
                            value="DNE"
                            class="text-gray-900 dark:text-black-400"
                          >
                            SELESAI
                          </option>
                          <option
                            value="TAK"
                            class="text-gray-900 dark:text-black-400"
                          >
                            BELUM DIAMBIL
                          </option>
                        </select>
                        <div id="statusCellAdd"></div>
                      </div>
                      <div class="col-span-2">
                        <label
                          for="modBeratAdd"
                          class="block mb-2 text-sm font-medium text-gray-900 dark:text-white"
                        >
                          Berat
                        </label>
                        <input
                          x-model="addTransactionData.quantity"
                          type="text"
                          name="modBeratAdd"
                          id="modBeratAdd"
                          class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-primary-600 focus:border-primary-600 block w-full p-2.5 dark:bg-gray-600 dark:border-gray-500 dark:placeholder-gray-400 dark:focus:ring-primary-500 dark:focus:border-primary-500 dark:text-black-400"
                          placeholder="Ketik berat (Kg)"
                          required=""
                        />
                      </div>
                      <div class="col-span-2">
                        <label
                          for="modTanggalAdd"
                          class="block mb-2 text-sm font-medium text-gray-900 dark:text-white"
                        >
                          Tanggal Masuk
                        </label>
                        <input
                          type="date"
                          name="modTanggalAdd"
                          id="modTanggalAdd"
                          class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-primary-600 focus:border-primary-600 block w-full p-2.5 dark:bg-gray-600 dark:border-gray-500 dark:placeholder-gray-400 dark:focus:ring-primary-500 dark:focus:border-primary-500 dark:text-black-400"
                          placeholder="DD/MM/YY"
                          required=""
                          x-model="addTransactionData.entry_date"
                        />
                      </div>
                      <div class="col-span-2">
                        <label
                          for="tanggalKeluar"
                          class="block mb-2 text-sm font-medium text-gray-900 dark:text-white"
                        >
                          Tanggal Bayar
                        </label>
                        <input
                          type="date"
                          name="tanggalKeluar"
                          id="tanggalKeluar"
                          class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-primary-600 focus:border-primary-600 block w-full p-2.5 dark:bg-gray-600 dark:border-gray-500 dark:placeholder-gray-400 dark:focus:ring-primary-500 dark:focus:border-primary-500 dark:text-black-400"
                          placeholder="DD/MM/YY"
                          x-model="addTransactionData.payment_date"
                        />
                      </div>
                    </div>
                    <button
                      type="submit"
                      class="text-white inline-flex items-center bg-blue-700 hover:bg-blue-800 focus:ring-4 focus:outline-none focus:ring-blue-300 font-medium rounded-lg text-sm px-5 py-2.5 text-center dark:bg-blue-600 dark:hover:bg-blue-700 dark:focus:ring-blue-800"
                    >
                      <svg
                        class="me-1 -ms-1 w-5 h-5"
                        fill="currentColor"
                        viewBox="0 0 20 20"
                        xmlns="http://www.w3.org/2000/svg"
                      >
                        <path
                          fill-rule="evenodd"
                          d="M10 5a1 1 0 011 1v3h3a1 1 0 110 2h-3v3a1 1 0 11-2 0v-3H6a1 1 0 110-2h3V6a1 1 0 011-1z"
                          clip-rule="evenodd"
                        ></path>
                      </svg>
                      Tambah Data
                    </button>
                  </form>
                </div>
              </div>
            </div>
          </div>
          <div class="container px-6 mx-auto grid">
            <div class="grid gap-6 mb-8 md:grid-cols-2 xl:grid-cols-4">
              <!-- Card -->
              <div
                class="flex items-center p-4 bg-white rounded-lg shadow-xs dark:bg-gray-800"
              >
                <div
                  class="p-3 mr-4 text-orange-500 bg-orange-100 rounded-full dark:text-orange-100 dark:bg-orange-500"
                >
                  <!-- <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
                    <path
                      d="M13 6a3 3 0 11-6 0 3 3 0 016 0zM18 8a2 2 0 11-4 0 2 2 0 014 0zM14 15a4 4 0 00-8 0v3h8v-3zM6 8a2 2 0 11-4 0 2 2 0 014 0zM16 18v-3a5.972 5.972 0 00-.75-2.906A3.005 3.005 0 0119 15v3h-3zM4.75 12.094A5.973 5.973 0 004 15v3H1v-3a3 3 0 013.75-2.906z"
                    ></path>
                  </svg> -->
                  <i class="fa-solid fa-chart-line"></i>
                </div>
                <div>
                  <p
                    class="mb-2 text-sm font-medium text-gray-600 dark:text-gray-400"
                  >
                    Total Pesanan
                  </p>
                  <p
                    class="text-lg font-semibold text-gray-700 dark:text-gray-200"
                    x-text="transactionsCount"
                  ></p>
                </div>
              </div>
              <!-- Card -->
              <div
                class="flex items-center p-4 bg-white rounded-lg shadow-xs dark:bg-gray-800"
              >
                <div
                  class="p-3 mr-4 text-green-500 bg-green-100 rounded-full dark:text-green-100 dark:bg-green-500"
                >
                  <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
                    <path
                      fill-rule="evenodd"
                      d="M4 4a2 2 0 00-2 2v4a2 2 0 002 2V6h10a2 2 0 00-2-2H4zm2 6a2 2 0 012-2h8a2 2 0 012 2v4a2 2 0 01-2 2H8a2 2 0 01-2-2v-4zm6 4a2 2 0 100-4 2 2 0 000 4z"
                      clip-rule="evenodd"
                    ></path>
                  </svg>
                </div>
                <div>
                  <p
                    class="mb-2 text-sm font-medium text-gray-600 dark:text-gray-400"
                  >
                    Pemasukan
                  </p>
                  <p
                    class="text-lg font-semibold text-gray-700 dark:text-gray-200"
                    id="total-balance"
                    x-text="transactionsSum"
                  >
                    Rp. 10.000
                  </p>
                </div>
              </div>
              <!-- Card -->
              <div
                class="flex items-center p-4 bg-white rounded-lg shadow-xs dark:bg-gray-800"
              >
                <div
                  class="p-3 mr-4 text-blue-500 bg-blue-100 rounded-full dark:text-blue-100 dark:bg-blue-500"
                >
                  <!-- <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
                    <path
                      d="M3 1a1 1 0 000 2h1.22l.305 1.222a.997.997 0 00.01.042l1.358 5.43-.893.892C3.74 11.846 4.632 14 6.414 14H15a1 1 0 000-2H6.414l1-1H14a1 1 0 00.894-.553l3-6A1 1 0 0017 3H6.28l-.31-1.243A1 1 0 005 1H3zM16 16.5a1.5 1.5 0 11-3 0 1.5 1.5 0 013 0zM6.5 18a1.5 1.5 0 100-3 1.5 1.5 0 000 3z"
                    ></path>
                  </svg> -->
                  <i class="fa-solid fa-percent"></i>
                </div>
                <div>
                  <p
                    class="mb-2 text-sm font-medium text-gray-600 dark:text-gray-400"
                  >
                    Rata Rata Transaksi
                  </p>
                  <p
                    class="text-lg font-semibold text-gray-700 dark:text-gray-200"
                    x-text="transactionsAvg"
                  >
                    2
                  </p>
                </div>
              </div>
              <!-- Card -->
              <div
                class="flex items-center p-4 bg-white rounded-lg shadow-xs dark:bg-gray-800"
              >
                <div
                  class="p-3 mr-4 text-teal-500 bg-teal-100 rounded-full dark:text-teal-100 dark:bg-teal-500"
                >
                  <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
                    <path
                      d="M13 6a3 3 0 11-6 0 3 3 0 016 0zM18 8a2 2 0 11-4 0 2 2 0 014 0zM14 15a4 4 0 00-8 0v3h8v-3zM6 8a2 2 0 11-4 0 2 2 0 014 0zM16 18v-3a5.972 5.972 0 00-.75-2.906A3.005 3.005 0 0119 15v3h-3zM4.75 12.094A5.973 5.973 0 004 15v3H1v-3a3 3 0 013.75-2.906z"
                    ></path>
                  </svg>
                </div>
                <div>
                  <p
                    class="mb-2 text-sm font-medium text-gray-600 dark:text-gray-400"
                  >
                    Jumlah Pelanggan Bertransaksi
                  </p>
                  <p
                    class="text-lg font-semibold text-gray-700 dark:text-gray-200"
                    x-text="customersCount"
                  >
                    2
                  </p>
                </div>
              </div>
            </div>
            <div class="w-full overflow-hidden rounded-lg shadow-xs">
              <div class="w-full overflow-x-auto">
                <table class="w-full whitespace-no-wrap">
                  <thead>
                    <tr
                      class="text-xs font-semibold tracking-wide text-left text-gray-500 uppercase border-b dark:border-gray-700 bg-gray-50 dark:text-gray-400 dark:bg-gray-800"
                    >
                      <th class="px-4 py-3">ID Pesanan</th>
                      <th class="px-4 py-3">ID Pelanggan</th>
                      <th class="px-4 py-3">Nama</th>
                      <th class="px-4 py-3">Berat</th>
                      <th class="px-4 py-3">Harga</th>
                      <th class="px-4 py-3">Status</th>
                      <th class="px-4 py-3">Tanggal</th>
                      <th class="px-4 py-3">Tanggal Bayar</th>
                      <th class="px-4 py-3">Aksi</th>
                    </tr>
                  </thead>
                  <tbody
                    class="bg-white divide-y dark:divide-gray-700 dark:bg-gray-800"
                  >
                    <template x-for="transaction in paginatedItems">
                      <tr class="text-gray-700 dark:text-gray-400">
                        <td
                          class="idPesanan px-4 py-3 font-semibold"
                          x-text="transaction?.id"
                        >
                          L01
                        </td>
                        <td class="px-4 py-3">
                          <div class="flex items-center text-sm">
                            <div>
                              <p
                                class="idPelanggan"
                                x-text="transaction?.customer_id"
                              >
                                P001
                              </p>
                            </div>
                          </div>
                        </td>
                        <td class="px-4 py-3">
                          <div class="flex items-center text-sm">
                            <div>
                              <p
                                class="namaPelanggan"
                                x-text="transaction?.name"
                              >
                                John Doe
                              </p>
                            </div>
                          </div>
                        </td>

                        <td class="beratL px-4 py-3 text-sm">
                          <span x-text="transaction?.quantity"></span>
                          Kg
                        </td>
                        <td
                          class="hargaL px-4 py-3 text-sm"
                          x-text="Intl.NumberFormat('id-ID').format(transaction?.total_amount)"
                        >
                          Rp. 18.000
                        </td>
                        <td
                          id="statusCell"
                          class="statusL px-4 py-3 text-xs uppercase"
                          x-text="transaction?.status"
                        >
                          <!-- Konten status akan diubah di sini -->
                        </td>
                        <td
                          class="tanggalL px-4 py-3 text-sm"
                          x-text="transaction?.entry_date ? new Intl.DateTimeFormat('id-ID').format(new Date(transaction?.entry_date)):''"
                        >
                          24/04/2024
                        </td>
                        <td
                          class="bayarL px-4 py-3 text-sm"
                          x-text="transaction?.payment_date ? new Intl.DateTimeFormat('id-ID').format(new Date(transaction?.payment_date)) : '-'"
                        >
                          25/04/2024
                        </td>
                        <td class="px-4 py-3">
                          <div class="flex items-center space-x-4 text-sm">
                            <button
                              data-modal-toggle="edit-modal"
                              type="button"
                              class="flex items-center justify-between px-2 py-2 text-sm font-medium leading-5 text-blue-600 rounded-lg dark:text-gray-400 focus:outline-none focus:shadow-outline-gray"
                              aria-label="Edit"
                              @click="modal.edit.open(transaction)"
                            >
                              <svg
                                class="w-5 h-5"
                                aria-hidden="true"
                                fill="currentColor"
                                viewBox="0 0 20 20"
                              >
                                <path
                                  d="M13.586 3.586a2 2 0 112.828 2.828l-.793.793-2.828-2.828.793-.793zM11.379 5.793L3 14.172V17h2.828l8.38-8.379-2.83-2.828z"
                                ></path>
                              </svg>
                            </button>
                            <!-- Main modal -->

                            <button
                              type="button"
                              id="delete"
                              class="flex items-center justify-between px-2 py-2 text-sm font-medium leading-5 text-blue-600 rounded-lg dark:text-gray-400 focus:outline-none focus:shadow-outline-gray"
                              aria-label="Delete"
                              data-modal-toggle="popup-modal"
                              @click="modal.delete.open(transaction?.id)"
                            >
                              <svg
                                class="w-5 h-5"
                                aria-hidden="true"
                                fill="currentColor"
                                viewBox="0 0 20 20"
                              >
                                <path
                                  fill-rule="evenodd"
                                  d="M9 2a1 1 0 00-.894.553L7.382 4H4a1 1 0 000 2v10a2 2 0 002 2h8a2 2 0 002-2V6a1 1 0 100-2h-3.382l-.724-1.447A1 1 0 0011 2H9zM7 8a1 1 0 012 0v6a1 1 0 11-2 0V8zm5-1a1 1 0 00-1 1v6a1 1 0 102 0V8a1 1 0 00-1-1z"
                                  clip-rule="evenodd"
                                ></path>
                              </svg>
                            </button>
                          </div>
                        </td>
                      </tr>
                    </template>
                  </tbody>
                </table>
              </div>
              <div
                class="grid px-4 py-3 text-xs font-semibold tracking-wide text-gray-500 uppercase border-t dark:border-gray-700 bg-gray-50 sm:grid-cols-9 dark:text-gray-400 dark:bg-gray-800"
                id="pagination"
              >
                <span class="flex items-center col-span-3">
                  Menampilkan
                  <span x-text="startData + 1" class="mx-1"></span>
                  -
                  <span x-text="endData" class="mx-1"></span>
                  dari
                  <span x-text="transactions.length" class="ml-1"></span>
                </span>
                <span class="col-span-2"></span>
                <!-- Pagination -->
                <span class="flex col-span-4 mt-2 sm:mt-auto sm:justify-end">
                  <nav aria-label="Table navigation">
                    <ul class="inline-flex items-center">
                      <li>
                        <button
                          class="px-3 py-1 rounded-md rounded-l-lg focus:outline-none focus:shadow-outline-blue"
                          aria-label="Previous"
                          @click="prevPage()"
                        >
                          <svg
                            aria-hidden="true"
                            class="w-4 h-4 fill-current pointer-events-none"
                            viewBox="0 0 20 20"
                          >
                            <path
                              d="M12.707 5.293a1 1 0 010 1.414L9.414 10l3.293 3.293a1 1 0 01-1.414 1.414l-4-4a1 1 0 010-1.414l4-4a1 1 0 011.414 0z"
                              clip-rule="evenodd"
                              fill-rule="evenodd"
                              class="pointer-events-none"
                            ></path>
                          </svg>
                        </button>
                      </li>
                      <template x-for="i in pagesToShow">
                        <button
                          x-text="`${i }`"
                          :class="parseInt(await currentPage) == parseInt(i) ? activeClass: inactiveClass"
                          @click="choosePage(i)"
                        ></button>
                      </template>
                      <li></li>

                      <li>
                        <button
                          class="px-3 py-1 rounded-md rounded-r-lg focus:outline-none focus:shadow-outline-blue"
                          aria-label="Next"
                          @click="nextPage()"
                        >
                          <svg
                            class="w-4 h-4 fill-current pointer-events-none"
                            aria-hidden="true"
                            viewBox="0 0 20 20"
                          >
                            <path
                              d="M7.293 14.707a1 1 0 010-1.414L10.586 10 7.293 6.707a1 1 0 011.414-1.414l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414 0z"
                              clip-rule="evenodd"
                              fill-rule="evenodd"
                              class="pointer-events-none"
                            ></path>
                          </svg>
                        </button>
                      </li>
                    </ul>
                  </nav>
                </span>
              </div>
            </div>
          </div>
          <div
            id="edit-modal"
            tabindex="-1"
            aria-hidden="true"
            x-show="modal.edit.isOpen"
            class="overflow-y-auto overflow-x-hidden fixed top-0 right-0 left-0 z-50 justify-center items-center w-full md:inset-0 h-[calc(100%-1rem)] max-h-full flex"
          >
            <div class="relative p-4 w-full max-w-md max-h-full">
              <!-- Modal content -->
              <div class="relative bg-white rounded-lg shadow dark:bg-gray-700">
                <!-- Modal header -->
                <div
                  class="flex items-center justify-between p-4 md:p-5 border-b rounded-t dark:border-gray-600"
                >
                  <h3
                    class="text-lg font-semibold text-gray-900 dark:text-white"
                  >
                    Edit Data Pemesanan
                  </h3>
                  <button
                    type="button"
                    class="text-gray-400 bg-transparent hover:bg-gray-200 hover:text-gray-900 rounded-lg text-sm w-8 h-8 ms-auto inline-flex justify-center items-center dark:hover:bg-gray-600 dark:hover:text-white"
                    data-modal-toggle="edit-modal"
                    @click="modal.edit.close()"
                  >
                    <svg
                      class="w-3 h-3"
                      aria-hidden="true"
                      xmlns="http://www.w3.org/2000/svg"
                      fill="none"
                      viewBox="0 0 14 14"
                    >
                      <path
                        stroke="currentColor"
                        stroke-linecap="round"
                        stroke-linejoin="round"
                        stroke-width="2"
                        d="m1 1 6 6m0 0 6 6M7 7l6-6M7 7l-6 6"
                      />
                    </svg>
                    <span class="sr-only">Close modal</span>
                  </button>
                </div>
                <!-- Modal body -->
                <form
                    class="p-4 md:p-5"
                    @submit.prevent="confirmUpdate"
                  >
                    <div class="grid gap-4 mb-4 grid-cols-2">
                      <div class="col-span-2">
                        <label
                          for="idPelangganEdit"
                          class="block mb-2 text-sm font-medium text-gray-900 dark:text-white"
                        >
                          Pelanggan
                        </label>
                        <select
                          id="idPelangganEdit"
                          x-model="modal.edit.data.customer_id"
                          class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-primary-500 focus:border-primary-500 block w-full p-2.5 dark:bg-gray-600 dark:border-gray-500 dark:text-black-400 dark:placeholder-gray-400 dark:focus:ring-primary-500 dark:focus:border-primary-500"
                          required
                        >
                          <option
                            selected
                            disabled
                            class="text-gray-500 dark:text-black-400"
                            value=""
                          >
                            Pilih ID
                          </option>
                          <template x-for="customer in customers.reverse()">
                            <option
                              :value="customer.id"
                              class="text-gray-500 dark:text-black-400"
                              x-text="`${customer.id} - ${customer.name}`"
                            ></option>
                          </template>
                        </select>
                      </div>

                      <div class="col-span-2">
                        <label
                          for="priceEdit"
                          class="block mb-2 text-sm font-medium text-gray-900 dark:text-white"
                        >
                          Harga
                        </label>
                        <input
                          type="number"
                          name="priceEdit"
                          id="priceEdit"
                          class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-primary-600 focus:border-primary-600 block w-full p-2.5 dark:bg-gray-600 dark:border-gray-500 dark:text-black-400 dark:placeholder-gray-400 dark:focus:ring-primary-500 dark:focus:border-primary-500"
                          placeholder="Rp. -"
                          required
                          x-model="modal.edit.data.total_amount"
                        />
                      </div>
                      <div class="col-span-2">
                        <label
                          for="statusEdit"
                          class="block mb-2 text-sm font-medium text-gray-900 dark:text-white"
                        >
                          Status
                        </label>
                        <select
                          id="statusEdit"
                          class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-primary-500 focus:border-primary-500 block w-full p-2.5 dark:bg-gray-600 dark:border-gray-500 dark:text-black-400 dark:placeholder-gray-400 dark:focus:ring-primary-500 dark:focus:border-primary-500"
                          x-model="modal.edit.data.status"
                        >
                          <option
                            selected
                            disabled
                            class="text-gray-500 dark:text-black-400"
                          >
                            Pilih Status
                          </option>
                          <option
                            value="PRC"
                            class="text-gray-900 dark:text-black-400"
                          >
                            DIPROSES
                          </option>
                          <option
                            value="TAK"
                            class="text-gray-900 dark:text-black-400"
                          >
                            SELESAI
                          </option>
                          <option
                            value="DNE"
                            class="text-gray-900 dark:text-black-400"
                          >
                            BELUM DIAMBIL
                          </option>
                        </select>
                        <div id="statusCellEdit"></div>
                      </div>
                      <div class="col-span-2">
                        <label
                          for="modBeratEdit"
                          class="block mb-2 text-sm font-medium text-gray-900 dark:text-white"
                        >
                          Berat
                        </label>
                        <input
                          x-model="modal.edit.data.quantity"
                          type="text"
                          name="modBeratEdit"
                          id="modBeratEdit"
                          class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-primary-600 focus:border-primary-600 block w-full p-2.5 dark:bg-gray-600 dark:border-gray-500 dark:placeholder-gray-400 dark:focus:ring-primary-500 dark:focus:border-primary-500 dark:text-black-400"
                          placeholder="Ketik berat (Kg)"
                          required=""
                        />
                      </div>
                      <div class="col-span-2">
                        <label
                          for="modTanggalEdit"
                          class="block mb-2 text-sm font-medium text-gray-900 dark:text-white"
                        >
                          Tanggal Masuk
                        </label>
                        <input
                          type="date"
                          name="modTanggalEdit"
                          id="modTanggalEdit"
                          class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-primary-600 focus:border-primary-600 block w-full p-2.5 dark:bg-gray-600 dark:border-gray-500 dark:placeholder-gray-400 dark:focus:ring-primary-500 dark:focus:border-primary-500 dark:text-black-400"
                          placeholder="DD/MM/YY"
                          required=""
                          x-model="modal.edit.data.entry_date"
                        />
                      </div>
                      <div class="col-span-2">
                        <label
                          for="tanggalKeluar"
                          class="block mb-2 text-sm font-medium text-gray-900 dark:text-white"
                        >
                          Tanggal Bayar
                        </label>
                        <input
                          type="date"
                          name="tanggalKeluar"
                          id="tanggalKeluar"
                          class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-primary-600 focus:border-primary-600 block w-full p-2.5 dark:bg-gray-600 dark:border-gray-500 dark:placeholder-gray-400 dark:focus:ring-primary-500 dark:focus:border-primary-500 dark:text-black-400"
                          placeholder="DD/MM/YY"
                          x-model="modal.edit.data.payment_date"
                        />
                      </div>
                    </div>
                    <button
                      type="submit"
                      class="text-white inline-flex items-center bg-blue-700 hover:bg-blue-800 focus:ring-4 focus:outline-none focus:ring-blue-300 font-medium rounded-lg text-sm px-5 py-2.5 text-center dark:bg-blue-600 dark:hover:bg-blue-700 dark:focus:ring-blue-800"
                    >
                      <svg
                        class="me-1 -ms-1 w-5 h-5"
                        fill="currentColor"
                        viewBox="0 0 20 20"
                        xmlns="http://www.w3.org/2000/svg"
                      >
                        <path
                          fill-rule="evenodd"
                          d="M10 5a1 1 0 011 1v3h3a1 1 0 110 2h-3v3a1 1 0 11-2 0v-3H6a1 1 0 110-2h3V6a1 1 0 011-1z"
                          clip-rule="evenodd"
                        ></path>
                      </svg>
                      Ubah Data
                    </button>
                  </form>
                </form>
              </div>
            </div>
          </div>
          <div
            id="popup-modal"
            tabindex="-1"
            x-show="modal.delete.isOpen"
            class="overflow-y-auto overflow-x-hidden fixed top-0 right-0 left-0 z-50 justify-center items-center w-full md:inset-0 h-[calc(100%-1rem)] max-h-full flex"
          >
            <div class="relative p-4 w-full max-w-md max-h-full">
              <div class="relative bg-white rounded-lg shadow dark:bg-gray-700">
                <button
                  type="button"
                  class="absolute top-3 end-2.5 text-gray-400 bg-transparent hover:bg-gray-200 hover:text-gray-900 rounded-lg text-sm w-8 h-8 ms-auto inline-flex justify-center items-center dark:hover:bg-gray-600 dark:hover:text-white"
                  data-modal-hide="popup-modal"
                  @click="modal.delete.close()"
                >
                  <svg
                    class="w-3 h-3"
                    aria-hidden="true"
                    xmlns="http://www.w3.org/2000/svg"
                    fill="none"
                    viewBox="0 0 14 14"
                  >
                    <path
                      stroke="currentColor"
                      stroke-linecap="round"
                      stroke-linejoin="round"
                      stroke-width="2"
                      d="m1 1 6 6m0 0 6 6M7 7l6-6M7 7l-6 6"
                    />
                  </svg>
                  <span class="sr-only">Close modal</span>
                </button>
                <div class="p-4 md:p-5 text-center">
                  <svg
                    class="mx-auto mb-4 text-gray-400 w-12 h-12 dark:text-gray-200"
                    aria-hidden="true"
                    xmlns="http://www.w3.org/2000/svg"
                    fill="none"
                    viewBox="0 0 20 20"
                  >
                    <path
                      stroke="currentColor"
                      stroke-linecap="round"
                      stroke-linejoin="round"
                      stroke-width="2"
                      d="M10 11V6m0 8h.01M19 10a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"
                    />
                  </svg>
                  <h3
                    class="mb-5 text-lg font-normal text-gray-500 dark:text-gray-400"
                  >
                    Apakah anda yakin ingin menghapus?
                  </h3>
                  <button
                    @click="confirmDelete()"
                    type="button"
                    class="text-white bg-red-600 hover:bg-red-800 focus:ring-4 focus:outline-none focus:ring-red-300 dark:focus:ring-red-800 font-medium rounded-lg text-sm inline-flex items-center px-5 py-2.5 text-center"
                  >
                    Ya, saya yakin
                  </button>
                  <button
                    data-modal-hide="popup-modal"
                    type="button"
                    class="py-2.5 px-5 ms-3 text-sm font-medium text-gray-900 focus:outline-none bg-white rounded-lg border border-gray-200 hover:bg-gray-100 hover:text-blue-700 focus:z-10 focus:ring-4 focus:ring-gray-100 dark:focus:ring-gray-700 dark:bg-gray-800 dark:text-gray-400 dark:border-gray-600 dark:hover:text-white dark:hover:bg-gray-700"
                    @click="modal.delete.close()"
                  >
                    Tidak
                  </button>
                </div>
              </div>
            </div>
          </div>
        </main>
      </div>
    </div>

    <script>
      function getThemeFromLocalStorage() {
        // if user already changed the theme, use it
        if (window.localStorage.getItem('dark')) {
          return JSON.parse(window.localStorage.getItem('dark'))
        }

        // else return their preferences
        return (
          !!window.matchMedia &&
          window.matchMedia('(prefers-color-scheme: dark)').matches
        )
      }

      function setThemeToLocalStorage(value) {
        window.localStorage.setItem('dark', value)
      }
      document.addEventListener('alpine:init', () => {
        const BASE_URL = 'http://localhost:3000'
        Alpine.data('root', () => ({
          dark: getThemeFromLocalStorage(),
          toggleTheme() {
            this.dark = !this.dark
            setThemeToLocalStorage(this.dark)
          },
          isSideMenuOpen: false,
          toggleSideMenu() {
            this.isSideMenuOpen = !this.isSideMenuOpen
          },
          closeSideMenu() {
            this.isSideMenuOpen = false
          },

          isModalOpen: false,
          trapCleanup: null,
          openModal() {
            this.isModalOpen = true
          },
          closeModal() {
            this.isModalOpen = false
          },

          

          addTransactionData: {
            customer_id: '',
            entry_date: new Date().toISOString().substring(0, 10),
            payment_date: '',
            total_amount: '',
            quantity: '',
            status: 'PRC',
          },

          modal: {
            delete: {
              isOpen: false,
              open(id) {
                this.isOpen = true
                this.data.id = id
              },
              close() {
                this.isOpen = false
                this.data.id = ''
              },
              data: {
                id: '',
              },
            },
            edit: {
              isOpen: false,
              open(transaction) {
                const statuses = {selesai: "TAK","belum diambil" : "DNE",diproses :"PRC"}
                this.isOpen = true
                this.data = transaction
                this.data.entry_date = transaction.entry_date?.substring(0,10)
                this.data.payment_date = transaction.payment_date?.substring(0,10)
                delete this.data.status
                this.data.status = statuses[transaction.status]
              },
              close() {
                this.isOpen = false
                this.data.id = ''
              },
              data: {
                id: '',
                customer_id: '',
                entry_date: '',
                payment_date: '',
                total_amount: '',
                quantity: '',
                status: '',
              },
            },
          },
          confirmDelete() {
            fetch(BASE_URL + '/transactions/' + this.modal.delete.data.id, {
              method: 'DELETE',
            })
              .then((response) => {
                if (response.ok) {
                  Swal.fire({
                    icon: 'success',
                    title: 'Berhasil',
                    text: 'Data berhasil dihapus',
                    showConfirmButton: false,
                    timer: 1500,
                  })
                  this.modal.delete.isOpen = false
                  this.init()
                } else {
                  throw Error()
                }
              })
              .catch(() => {
                Swal.fire({
                  icon: 'error',
                  title: 'Gagal',
                  text: 'Data gagal dihapus',
                  showConfirmButton: false,
                  timer: 1500,
                })
                this.modal.delete.isOpen = false
                 this.init()
              })
          },
          confirmUpdate(e) {
            e.preventDefault()
            const jsonData = JSON.stringify(this.modal.edit.data)
            fetch(BASE_URL + '/transactions/' + this.modal.edit.data.id, {
              method: 'PUT',
              headers: {
                'Content-Type': 'application/json',
              },
              body: jsonData,
            }).then(() => {
              Swal.fire({
                icon:'success',
                title: 'Berhasil',
                text: 'Data berhasil diubah',
                showConfirmButton: false,
                timer: 1500,
              })
              this.modal.edit.isOpen = false
              // location.reload()
            }).catch(()=> {
              Swal.fire({
                icon: 'error',
                title: 'Gagal',
                text: 'Data gagal diubah',
                showConfirmButton: false,
                timer: 1500,
              })
              this.modal.edit.isOpen = false
            })
            
          },
          submitAddTransactions(e) {
            e.preventDefault()
            const jsonData = JSON.stringify({
              ...this.addTransactionData,
              entry_date: new Date(
                this.addTransactionData.entry_date
              ).toISOString(),
              payment_date: this.addTransactionData.payment_date
                ? new Date(this.addTransactionData.payment_date).toISOString()
                : null,
              total_amount: parseInt(this.addTransactionData.total_amount) || 0,
              quantity: parseFloat(this.addTransactionData.quantity) || 0,
            })
            fetch(BASE_URL + '/transactions', {
              method: 'POST',
              headers: {
                'Content-Type': 'application/json',
              },
              body: jsonData,
            }).then((response) => {
              if (response.ok) {
                Swal.fire({
                  icon: 'success',
                  title: 'Berhasil',
                  text: 'Data berhasil ditambahkan',
                  showConfirmButton: false,
                  timer: 1500,
                })
                e.target.reset()
                this.closeModal()
                location.reload()
              } else {
                Swal.fire({
                  icon: 'error',
                  title: 'Gagal',
                  text: 'Data gagal ditambahkan',
                  showConfirmButton: false,
                  timer: 1500,
                })
              }
            })
          },
          transactions: [null],
          customers: [],
          transactionsCount: 0,
          transactionsSum: 0,
          transactionsAvg: 0,
          customersCount: 0,
          currentPage: 1,
          dataPerPage: 10,
          activeClass:
            'px-3 py-1 text-white transition-colors duration-150 bg-blue-600 border border-r-0 border-blue-600 rounded-md focus:outline-none focus:shadow-outline-blue active',
          inactiveClass:
            'px-3 py-1 rounded-md focus:outline-none focus:shadow-outline-blue',
          get startData() {
            return (this.currentPage - 1) * this.dataPerPage
          },
          get endData() {
            return this.startData + this.dataPerPage
          },
          get paginatedItems() {
            return this.transactions.slice(this.startData, this.endData)
          },
          get totalPages() {
            return Math.ceil(this.transactions.length / this.dataPerPage)
          },
          nextPage() {
            if (this.currentPage < this.totalPages) {
              this.currentPage++
            }
          },
          prevPage() {
            if (this.currentPage > 1) {
              this.currentPage--
            }
          },
          get pagesToShow() {
            let pages = []
            if (this.totalPages <= 5) {
              for (let i = 1; i <= this.totalPages; i++) {
                pages.push(i)
              }
            } else {
              pages.push(1)
              if (this.currentPage > 3) {
                pages.push('...')
              }
              for (
                let i = this.currentPage - 1;
                i <= this.currentPage + 1;
                i++
              ) {
                if (i > 1 && i < this.totalPages) {
                  pages.push(i)
                }
              }
              if (this.currentPage < this.totalPages - 2) {
                pages.push('...')
              }
              pages.push(this.totalPages)
            }
            return pages
          },
          isProfileMenuOpen: false,
          toggleProfileMenu() {
            this.isProfileMenuOpen = !this.isProfileMenuOpen
          },
          closeProfileMenu() {
            this.isProfileMenuOpen = false
          },
          choosePage(page) {
            if (page === '...') return
            this.currentPage = page
          },
          init: async function () {
            const { count: transactionsCount } = await fetch(
              BASE_URL + '/insights/transactions/count'
            ).then((response) => response.json())
            this.transactionsCount = transactionsCount

            const { sum: transactionsSum } = await fetch(
              BASE_URL + '/insights/transactions/sum'
            ).then((response) => response.json())
            this.transactionsSum =
              'Rp' + Intl.NumberFormat('id-ID').format(transactionsSum)

            const { avg: transactionsAvg } = await fetch(
              BASE_URL + '/insights/transactions/average'
            ).then((response) => response.json())
            this.transactionsAvg =
              'Rp' + Intl.NumberFormat('id-ID').format(transactionsAvg)

            const { customersCount: customersCount } = await fetch(
              BASE_URL + '/insights/transactions/customersCount'
            ).then((response) => response.json())
            this.customersCount = customersCount

            const transactions = await fetch(BASE_URL + '/transactions').then(
              (response) => response.json()
            )
            this.transactions = transactions

            const customers = await fetch(BASE_URL + '/customers').then(
              (response) => response.json()
            )
            this.customers = customers
          },
        }))
      })
    </script>
  </body>
</html>
